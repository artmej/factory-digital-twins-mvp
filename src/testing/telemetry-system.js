// üìä End-to-End Telemetry System for Anomaly Testing\n// Comprehensive tracking of anomaly propagation across all systems\n\nclass EndToEndTelemetrySystem {\n    constructor() {\n        this.name = \"E2E Telemetry System\";\n        this.isRecording = false;\n        this.sessionData = new Map();\n        this.currentSession = null;\n        this.metrics = {\n            propagationTimes: [],\n            systemImpacts: new Map(),\n            userInteractions: [],\n            performanceMetrics: [],\n            businessMetrics: []\n        };\n        \n        // üìà Tracking categories\n        this.trackingCategories = {\n            iot_sensors: {\n                name: 'IoT Sensors',\n                metrics: ['temperature', 'vibration', 'power_consumption', 'efficiency'],\n                expectedImpactTime: 0, // immediate\n                color: '#e74c3c'\n            },\n            digital_twins: {\n                name: 'Azure Digital Twins',\n                metrics: ['health_score', 'status', 'properties_updated'],\n                expectedImpactTime: 1000, // 1 second\n                color: '#3498db'\n            },\n            ml_models: {\n                name: 'ML Models',\n                metrics: ['anomaly_confidence', 'prediction_accuracy', 'model_response_time'],\n                expectedImpactTime: 3000, // 3 seconds\n                color: '#f39c12'\n            },\n            health_modeling: {\n                name: 'Health Modeling',\n                metrics: ['health_degradation', 'cascade_predictions', 'risk_assessment'],\n                expectedImpactTime: 3500, // 3.5 seconds\n                color: '#e67e22'\n            },\n            dashboard_ui: {\n                name: 'Dashboard UI',\n                metrics: ['ui_updates', 'alert_displays', 'metric_changes'],\n                expectedImpactTime: 5000, // 5 seconds\n                color: '#9b59b6'\n            },\n            visualization_3d: {\n                name: '3D Digital Twin',\n                metrics: ['material_updates', 'particle_effects', 'camera_focus'],\n                expectedImpactTime: 5500, // 5.5 seconds\n                color: '#1abc9c'\n            },\n            notifications: {\n                name: 'Notifications & Alerts',\n                metrics: ['browser_notifications', 'alert_panels', 'maintenance_updates'],\n                expectedImpactTime: 8000, // 8 seconds\n                color: '#34495e'\n            }\n        };\n        \n        this.init();\n    }\n    \n    // üöÄ Initialize Telemetry System\n    init() {\n        console.log('üìä Initializing End-to-End Telemetry System...');\n        \n        // Create telemetry dashboard\n        this.createTelemetryDashboard();\n        \n        // Set up event listeners\n        this.setupEventListeners();\n        \n        // Initialize performance monitoring\n        this.initializePerformanceMonitoring();\n        \n        console.log('‚úÖ E2E Telemetry System ready for recording');\n    }\n    \n    // üìä Create Telemetry Dashboard\n    createTelemetryDashboard() {\n        const telemetryPanel = document.createElement('div');\n        telemetryPanel.id = 'telemetry-dashboard';\n        telemetryPanel.innerHTML = this.createTelemetryHTML();\n        \n        // Position as floating panel\n        telemetryPanel.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 15px;\n            box-shadow: 0 10px 25px rgba(52,73,94,0.3);\n            backdrop-filter: blur(10px);\n            z-index: 2000;\n            min-width: 400px;\n            max-height: 80vh;\n            overflow-y: auto;\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Courier New', monospace;\n        `;\n        \n        document.body.appendChild(telemetryPanel);\n        \n        // Add event listeners\n        this.setupTelemetryEvents();\n    }\n    \n    // üé® Create Telemetry HTML\n    createTelemetryHTML() {\n        return `\n            <div style=\"display: flex; align-items: center; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 10px;\">\n                <h2 style=\"margin: 0; font-size: 16px; font-weight: bold;\">üìä E2E Telemetry</h2>\n                <div style=\"margin-left: auto; display: flex; gap: 10px;\">\n                    <button id=\"telemetry-record\" style=\"\n                        background: #27ae60; color: white; border: none;\n                        padding: 5px 10px; border-radius: 5px; cursor: pointer;\n                        font-size: 11px;\n                    \">üî¥ REC</button>\n                    <button id=\"telemetry-minimize\" style=\"\n                        background: none; border: none; color: white;\n                        font-size: 18px; cursor: pointer; padding: 5px;\n                    \">‚àí</button>\n                </div>\n            </div>\n            \n            <div id=\"telemetry-content\">\n                <div style=\"margin: 10px 0; padding: 8px; background: rgba(0,0,0,0.3); border-radius: 8px;\">\n                    <div style=\"font-size: 12px; font-weight: bold; margin-bottom: 5px;\">üìà Session Status</div>\n                    <div id=\"session-status\" style=\"font-size: 11px;\">‚è∏Ô∏è Not Recording</div>\n                    <div id=\"session-time\" style=\"font-size: 11px; opacity: 0.8;\">Duration: 00:00</div>\n                </div>\n                \n                <div style=\"margin: 15px 0;\">\n                    <h4 style=\"margin: 0 0 10px 0; font-size: 12px;\">üåä Propagation Timeline</h4>\n                    <div id=\"propagation-timeline\" style=\"\n                        background: rgba(0,0,0,0.3); border-radius: 8px;\n                        padding: 10px; min-height: 120px; position: relative;\n                    \">\n                        <div style=\"text-align: center; opacity: 0.7; font-size: 11px; padding: 40px 0;\">\n                            Start recording to see propagation timeline\n                        </div>\n                    </div>\n                </div>\n                \n                <div style=\"margin: 15px 0;\">\n                    <h4 style=\"margin: 0 0 10px 0; font-size: 12px;\">üéØ System Impact Metrics</h4>\n                    <div id=\"impact-metrics\" style=\"\n                        display: grid; grid-template-columns: 1fr 1fr;\n                        gap: 8px; font-size: 11px;\n                    \">\n                        <div class=\"metric-card\" style=\"\n                            background: rgba(231,76,60,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #e74c3c;\n                        \">\n                            <div style=\"font-weight: bold;\">IoT Sensors</div>\n                            <div id=\"iot-impact\">‚è≥ Waiting</div>\n                        </div>\n                        \n                        <div class=\"metric-card\" style=\"\n                            background: rgba(52,152,219,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #3498db;\n                        \">\n                            <div style=\"font-weight: bold;\">Digital Twins</div>\n                            <div id=\"dt-impact\">‚è≥ Waiting</div>\n                        </div>\n                        \n                        <div class=\"metric-card\" style=\"\n                            background: rgba(243,156,18,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #f39c12;\n                        \">\n                            <div style=\"font-weight: bold;\">ML Models</div>\n                            <div id=\"ml-impact\">‚è≥ Waiting</div>\n                        </div>\n                        \n                        <div class=\"metric-card\" style=\"\n                            background: rgba(155,89,182,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #9b59b6;\n                        \">\n                            <div style=\"font-weight: bold;\">Dashboard UI</div>\n                            <div id=\"ui-impact\">‚è≥ Waiting</div>\n                        </div>\n                        \n                        <div class=\"metric-card\" style=\"\n                            background: rgba(26,188,156,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #1abc9c;\n                        \">\n                            <div style=\"font-weight: bold;\">3D Visualization</div>\n                            <div id=\"3d-impact\">‚è≥ Waiting</div>\n                        </div>\n                        \n                        <div class=\"metric-card\" style=\"\n                            background: rgba(52,73,94,0.2); padding: 8px;\n                            border-radius: 5px; border-left: 3px solid #34495e;\n                        \">\n                            <div style=\"font-weight: bold;\">Notifications</div>\n                            <div id=\"notification-impact\">‚è≥ Waiting</div>\n                        </div>\n                    </div>\n                </div>\n                \n                <div style=\"margin: 15px 0;\">\n                    <h4 style=\"margin: 0 0 10px 0; font-size: 12px;\">üìä Performance Metrics</h4>\n                    <div id=\"performance-stats\" style=\"\n                        background: rgba(0,0,0,0.3); border-radius: 8px;\n                        padding: 10px; font-size: 11px;\n                    \">\n                        <div>‚ö° Avg Response Time: <span id=\"avg-response-time\">-</span>ms</div>\n                        <div>üéØ Success Rate: <span id=\"success-rate\">-</span>%</div>\n                        <div>üîÑ Total Events: <span id=\"total-events\">0</span></div>\n                        <div>üí∞ Business Impact: $<span id=\"business-impact\">0</span>/hr</div>\n                    </div>\n                </div>\n                \n                <div style=\"margin: 15px 0;\">\n                    <h4 style=\"margin: 0 0 10px 0; font-size: 12px;\">üìù Event Log</h4>\n                    <div id=\"event-log\" style=\"\n                        background: rgba(0,0,0,0.5); border-radius: 8px;\n                        padding: 10px; max-height: 150px; overflow-y: auto;\n                        font-family: 'Courier New', monospace; font-size: 10px;\n                    \">\n                        <div style=\"opacity: 0.7;\">Waiting for anomaly injection...</div>\n                    </div>\n                </div>\n                \n                <div style=\"margin: 15px 0; display: flex; gap: 10px;\">\n                    <button id=\"export-telemetry\" style=\"\n                        flex: 1; background: #16a085; color: white; border: none;\n                        padding: 8px; border-radius: 5px; cursor: pointer;\n                        font-size: 11px;\n                    \">üìä Export Data</button>\n                    \n                    <button id=\"clear-telemetry\" style=\"\n                        flex: 1; background: #e74c3c; color: white; border: none;\n                        padding: 8px; border-radius: 5px; cursor: pointer;\n                        font-size: 11px;\n                    \">üóëÔ∏è Clear Data</button>\n                </div>\n            </div>\n        `;\n    }\n    \n    // ‚öôÔ∏è Setup Telemetry Events\n    setupTelemetryEvents() {\n        // Record button\n        document.getElementById('telemetry-record').addEventListener('click', () => {\n            this.toggleRecording();\n        });\n        \n        // Minimize button\n        document.getElementById('telemetry-minimize').addEventListener('click', () => {\n            this.toggleMinimize();\n        });\n        \n        // Export button\n        document.getElementById('export-telemetry').addEventListener('click', () => {\n            this.exportTelemetryData();\n        });\n        \n        // Clear button\n        document.getElementById('clear-telemetry').addEventListener('click', () => {\n            this.clearTelemetryData();\n        });\n    }\n    \n    // üî¥ Toggle Recording\n    toggleRecording() {\n        const button = document.getElementById('telemetry-record');\n        const status = document.getElementById('session-status');\n        \n        if (this.isRecording) {\n            this.stopRecording();\n            button.textContent = 'üî¥ REC';\n            button.style.background = '#27ae60';\n            status.textContent = '‚è∏Ô∏è Recording Stopped';\n        } else {\n            this.startRecording();\n            button.textContent = '‚èπÔ∏è STOP';\n            button.style.background = '#e74c3c';\n            status.textContent = 'üî¥ Recording Active';\n        }\n    }\n    \n    // ‚ñ∂Ô∏è Start Recording\n    startRecording() {\n        this.isRecording = true;\n        this.currentSession = {\n            id: `SESSION_${Date.now()}`,\n            startTime: new Date(),\n            events: [],\n            propagationData: new Map(),\n            metrics: {\n                responseTimes: [],\n                successCount: 0,\n                errorCount: 0,\n                businessImpact: 0\n            }\n        };\n        \n        console.log(`üìä Started telemetry recording: ${this.currentSession.id}`);\n        \n        // Start session timer\n        this.startSessionTimer();\n        \n        // Clear previous data displays\n        this.clearDisplays();\n        \n        // Hook into anomaly generator events\n        this.hookIntoAnomalyEvents();\n        \n        this.logEvent('system', 'Telemetry recording started', 'success');\n    }\n    \n    // ‚èπÔ∏è Stop Recording\n    stopRecording() {\n        this.isRecording = false;\n        \n        if (this.currentSession) {\n            this.currentSession.endTime = new Date();\n            this.currentSession.duration = this.currentSession.endTime - this.currentSession.startTime;\n            \n            // Store session data\n            this.sessionData.set(this.currentSession.id, this.currentSession);\n            \n            console.log(`üìä Stopped telemetry recording: ${this.currentSession.id}`);\n            console.log('üìà Session Summary:', this.generateSessionSummary());\n            \n            this.logEvent('system', 'Telemetry recording stopped', 'success');\n        }\n        \n        // Clear timer\n        if (this.sessionTimer) {\n            clearInterval(this.sessionTimer);\n            this.sessionTimer = null;\n        }\n    }\n    \n    // ‚è±Ô∏è Start Session Timer\n    startSessionTimer() {\n        this.sessionTimer = setInterval(() => {\n            if (this.currentSession) {\n                const duration = Date.now() - this.currentSession.startTime.getTime();\n                const minutes = Math.floor(duration / 60000);\n                const seconds = Math.floor((duration % 60000) / 1000);\n                \n                document.getElementById('session-time').textContent = \n                    `Duration: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;\n            }\n        }, 1000);\n    }\n    \n    // üé£ Hook Into Anomaly Events\n    hookIntoAnomalyEvents() {\n        if (window.anomalyGenerator) {\n            const originalExecute = window.anomalyGenerator.executeAnomalyCascade;\n            window.anomalyGenerator.executeAnomalyCascade = async (anomalyConfig) => {\n                this.trackAnomalyStart(anomalyConfig);\n                return originalExecute.call(window.anomalyGenerator, anomalyConfig);\n            };\n            \n            // Hook into individual phase methods\n            this.hookPhaseMethod('impactFactorySensors', 'iot_sensors');\n            this.hookPhaseMethod('impactDigitalTwins', 'digital_twins');\n            this.hookPhaseMethod('impactMLModels', 'ml_models');\n            this.hookPhaseMethod('impactHealthModeling', 'health_modeling');\n            this.hookPhaseMethod('impactDashboard', 'dashboard_ui');\n            this.hookPhaseMethod('impact3DVisualization', 'visualization_3d');\n            this.hookPhaseMethod('triggerNotifications', 'notifications');\n        }\n    }\n    \n    // ü™ù Hook Phase Method\n    hookPhaseMethod(methodName, category) {\n        if (window.anomalyGenerator && window.anomalyGenerator[methodName]) {\n            const originalMethod = window.anomalyGenerator[methodName];\n            window.anomalyGenerator[methodName] = async (...args) => {\n                const startTime = performance.now();\n                \n                try {\n                    const result = await originalMethod.apply(window.anomalyGenerator, args);\n                    const endTime = performance.now();\n                    \n                    this.trackPhaseCompletion(category, startTime, endTime, 'success', args[0]);\n                    return result;\n                } catch (error) {\n                    const endTime = performance.now();\n                    this.trackPhaseCompletion(category, startTime, endTime, 'error', args[0], error);\n                    throw error;\n                }\n            };\n        }\n    }\n    \n    // üìä Track Anomaly Start\n    trackAnomalyStart(anomalyConfig) {\n        if (!this.isRecording || !this.currentSession) return;\n        \n        const event = {\n            timestamp: new Date(),\n            type: 'anomaly_start',\n            category: 'system',\n            data: {\n                anomaly_id: anomalyConfig.id,\n                anomaly_type: anomalyConfig.type,\n                target: anomalyConfig.target,\n                severity: anomalyConfig.config.severity,\n                expected_cost: anomalyConfig.config.cost_impact\n            }\n        };\n        \n        this.currentSession.events.push(event);\n        this.currentSession.propagationData.set(anomalyConfig.id, {\n            startTime: event.timestamp,\n            phases: new Map(),\n            completed: false\n        });\n        \n        this.logEvent('anomaly', `Started ${anomalyConfig.type} on ${anomalyConfig.target}`, 'info');\n        \n        // Update business impact\n        this.currentSession.metrics.businessImpact += anomalyConfig.config.cost_impact;\n        this.updateBusinessImpactDisplay();\n    }\n    \n    // üìà Track Phase Completion\n    trackPhaseCompletion(category, startTime, endTime, status, anomalyConfig, error = null) {\n        if (!this.isRecording || !this.currentSession || !anomalyConfig) return;\n        \n        const responseTime = endTime - startTime;\n        const event = {\n            timestamp: new Date(),\n            type: 'phase_complete',\n            category: category,\n            data: {\n                anomaly_id: anomalyConfig.id,\n                response_time: responseTime,\n                status: status,\n                error: error ? error.message : null\n            }\n        };\n        \n        this.currentSession.events.push(event);\n        this.currentSession.metrics.responseTimes.push(responseTime);\n        \n        if (status === 'success') {\n            this.currentSession.metrics.successCount++;\n        } else {\n            this.currentSession.metrics.errorCount++;\n        }\n        \n        // Update propagation data\n        const propagationData = this.currentSession.propagationData.get(anomalyConfig.id);\n        if (propagationData) {\n            propagationData.phases.set(category, {\n                completedAt: event.timestamp,\n                responseTime: responseTime,\n                status: status,\n                actualDelay: event.timestamp.getTime() - propagationData.startTime.getTime()\n            });\n        }\n        \n        // Update displays\n        this.updateImpactMetrics(category, responseTime, status);\n        this.updatePropagationTimeline();\n        this.updatePerformanceStats();\n        \n        this.logEvent(category, `Phase completed in ${responseTime.toFixed(1)}ms`, status);\n    }\n    \n    // üéØ Update Impact Metrics\n    updateImpactMetrics(category, responseTime, status) {\n        const elementMap = {\n            'iot_sensors': 'iot-impact',\n            'digital_twins': 'dt-impact',\n            'ml_models': 'ml-impact',\n            'health_modeling': 'ml-impact', // Same element\n            'dashboard_ui': 'ui-impact',\n            'visualization_3d': '3d-impact',\n            'notifications': 'notification-impact'\n        };\n        \n        const elementId = elementMap[category];\n        if (elementId) {\n            const element = document.getElementById(elementId);\n            if (element) {\n                const icon = status === 'success' ? '‚úÖ' : '‚ùå';\n                const color = status === 'success' ? '#27ae60' : '#e74c3c';\n                element.innerHTML = `\n                    <span style=\"color: ${color};\">${icon} ${responseTime.toFixed(1)}ms</span>\n                `;\n            }\n        }\n    }\n    \n    // üåä Update Propagation Timeline\n    updatePropagationTimeline() {\n        const timeline = document.getElementById('propagation-timeline');\n        if (!timeline) return;\n        \n        let timelineHTML = '';\n        \n        for (const [anomalyId, data] of this.currentSession.propagationData) {\n            const totalPhases = Object.keys(this.trackingCategories).length;\n            const completedPhases = data.phases.size;\n            const progressPercent = (completedPhases / totalPhases) * 100;\n            \n            timelineHTML += `\n                <div style=\"margin: 5px 0; padding: 5px; background: rgba(255,255,255,0.1); border-radius: 3px;\">\n                    <div style=\"font-size: 11px; font-weight: bold;\">${anomalyId.substr(0, 20)}...</div>\n                    <div style=\"\n                        width: 100%; height: 8px; background: rgba(0,0,0,0.3);\n                        border-radius: 4px; margin: 3px 0; overflow: hidden;\n                    \">\n                        <div style=\"\n                            width: ${progressPercent}%; height: 100%;\n                            background: linear-gradient(90deg, #3498db, #1abc9c);\n                            border-radius: 4px; transition: width 0.5s ease;\n                        \"></div>\n                    </div>\n                    <div style=\"font-size: 10px; opacity: 0.8;\">\n                        ${completedPhases}/${totalPhases} phases completed\n                    </div>\n                </div>\n            `;\n        }\n        \n        if (timelineHTML === '') {\n            timelineHTML = '<div style=\"text-align: center; opacity: 0.7; font-size: 11px; padding: 40px 0;\">No active anomalies</div>';\n        }\n        \n        timeline.innerHTML = timelineHTML;\n    }\n    \n    // üìä Update Performance Stats\n    updatePerformanceStats() {\n        const metrics = this.currentSession.metrics;\n        const totalEvents = metrics.successCount + metrics.errorCount;\n        const avgResponseTime = metrics.responseTimes.length > 0 ?\n            metrics.responseTimes.reduce((a, b) => a + b, 0) / metrics.responseTimes.length : 0;\n        const successRate = totalEvents > 0 ? (metrics.successCount / totalEvents) * 100 : 0;\n        \n        document.getElementById('avg-response-time').textContent = avgResponseTime.toFixed(1);\n        document.getElementById('success-rate').textContent = successRate.toFixed(1);\n        document.getElementById('total-events').textContent = totalEvents;\n    }\n    \n    // üí∞ Update Business Impact Display\n    updateBusinessImpactDisplay() {\n        const element = document.getElementById('business-impact');\n        if (element) {\n            element.textContent = this.currentSession.metrics.businessImpact.toLocaleString();\n        }\n    }\n    \n    // üìù Log Event\n    logEvent(category, message, level = 'info') {\n        if (!this.isRecording || !this.currentSession) return;\n        \n        const logElement = document.getElementById('event-log');\n        if (logElement) {\n            const timestamp = new Date().toISOString().substr(11, 12); // HH:mm:ss.sss\n            const levelColors = {\n                'success': '#27ae60',\n                'error': '#e74c3c',\n                'warning': '#f39c12',\n                'info': '#3498db'\n            };\n            \n            const logEntry = document.createElement('div');\n            logEntry.style.cssText = `\n                margin: 2px 0;\n                font-size: 10px;\n                opacity: 0.9;\n            `;\n            \n            logEntry.innerHTML = `\n                <span style=\"color: #95a5a6;\">${timestamp}</span>\n                <span style=\"color: ${levelColors[level] || '#ffffff'}; font-weight: bold;\">[${category.toUpperCase()}]</span>\n                <span>${message}</span>\n            `;\n            \n            logElement.appendChild(logEntry);\n            logElement.scrollTop = logElement.scrollHeight;\n            \n            // Keep only last 50 entries\n            while (logElement.children.length > 50) {\n                logElement.removeChild(logElement.firstChild);\n            }\n        }\n    }\n    \n    // üìä Export Telemetry Data\n    exportTelemetryData() {\n        const sessionSummary = this.generateSessionSummary();\n        const exportData = {\n            export_timestamp: new Date().toISOString(),\n            session_summary: sessionSummary,\n            raw_sessions: Array.from(this.sessionData.values()),\n            system_info: {\n                user_agent: navigator.userAgent,\n                viewport: `${window.innerWidth}x${window.innerHeight}`,\n                timestamp: new Date().toISOString()\n            }\n        };\n        \n        // Create download\n        const blob = new Blob([JSON.stringify(exportData, null, 2)], \n            { type: 'application/json' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `smart-factory-telemetry-${new Date().toISOString().split('T')[0]}.json`;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n        \n        this.logEvent('system', 'Telemetry data exported', 'success');\n    }\n    \n    // üìà Generate Session Summary\n    generateSessionSummary() {\n        if (!this.currentSession) return null;\n        \n        const metrics = this.currentSession.metrics;\n        const totalEvents = metrics.successCount + metrics.errorCount;\n        const avgResponseTime = metrics.responseTimes.length > 0 ?\n            metrics.responseTimes.reduce((a, b) => a + b, 0) / metrics.responseTimes.length : 0;\n        \n        return {\n            session_id: this.currentSession.id,\n            duration: this.currentSession.duration || (Date.now() - this.currentSession.startTime.getTime()),\n            total_events: totalEvents,\n            success_rate: totalEvents > 0 ? (metrics.successCount / totalEvents) * 100 : 0,\n            avg_response_time: avgResponseTime,\n            business_impact: metrics.businessImpact,\n            anomalies_tested: this.currentSession.propagationData.size,\n            phases_completed: Array.from(this.currentSession.propagationData.values())\n                .reduce((total, data) => total + data.phases.size, 0)\n        };\n    }\n    \n    // üóëÔ∏è Clear Telemetry Data\n    clearTelemetryData() {\n        this.sessionData.clear();\n        this.metrics = {\n            propagationTimes: [],\n            systemImpacts: new Map(),\n            userInteractions: [],\n            performanceMetrics: [],\n            businessMetrics: []\n        };\n        \n        this.clearDisplays();\n        this.logEvent('system', 'Telemetry data cleared', 'info');\n    }\n    \n    // üßπ Clear Displays\n    clearDisplays() {\n        // Clear propagation timeline\n        const timeline = document.getElementById('propagation-timeline');\n        if (timeline) {\n            timeline.innerHTML = '<div style=\"text-align: center; opacity: 0.7; font-size: 11px; padding: 40px 0;\">Start recording to see propagation timeline</div>';\n        }\n        \n        // Reset impact metrics\n        ['iot-impact', 'dt-impact', 'ml-impact', 'ui-impact', '3d-impact', 'notification-impact']\n            .forEach(id => {\n                const element = document.getElementById(id);\n                if (element) element.textContent = '‚è≥ Waiting';\n            });\n        \n        // Reset performance stats\n        document.getElementById('avg-response-time').textContent = '-';\n        document.getElementById('success-rate').textContent = '-';\n        document.getElementById('total-events').textContent = '0';\n        document.getElementById('business-impact').textContent = '0';\n        \n        // Clear event log\n        const eventLog = document.getElementById('event-log');\n        if (eventLog) {\n            eventLog.innerHTML = '<div style=\"opacity: 0.7;\">Waiting for anomaly injection...</div>';\n        }\n    }\n    \n    // Toggle minimize\n    toggleMinimize() {\n        const content = document.getElementById('telemetry-content');\n        const button = document.getElementById('telemetry-minimize');\n        \n        if (content.style.display === 'none') {\n            content.style.display = 'block';\n            button.textContent = '‚àí';\n        } else {\n            content.style.display = 'none';\n            button.textContent = '+';\n        }\n    }\n    \n    // Additional setup methods\n    setupEventListeners() {\n        // Listen for anomaly generator events\n        document.addEventListener('anomalyInjected', (event) => {\n            if (this.isRecording) {\n                this.trackAnomalyStart(event.detail);\n            }\n        });\n    }\n    \n    initializePerformanceMonitoring() {\n        // Monitor page performance\n        if ('PerformanceObserver' in window) {\n            const observer = new PerformanceObserver((list) => {\n                if (this.isRecording && this.currentSession) {\n                    for (const entry of list.getEntries()) {\n                        this.currentSession.metrics.performanceEntries = \n                            this.currentSession.metrics.performanceEntries || [];\n                        this.currentSession.metrics.performanceEntries.push({\n                            name: entry.name,\n                            duration: entry.duration,\n                            startTime: entry.startTime\n                        });\n                    }\n                }\n            });\n            \n            observer.observe({ entryTypes: ['measure', 'navigation'] });\n        }\n    }\n}\n\n// üöÄ Auto-initialize when loaded\nif (typeof window !== 'undefined') {\n    window.EndToEndTelemetrySystem = EndToEndTelemetrySystem;\n    \n    // Initialize after DOM is ready\n    document.addEventListener('DOMContentLoaded', () => {\n        // Initialize after anomaly generator\n        setTimeout(() => {\n            window.telemetrySystem = new EndToEndTelemetrySystem();\n            console.log('‚úÖ E2E Telemetry System ready for monitoring!');\n        }, 4000);\n    });\n}\n\nexport default EndToEndTelemetrySystem;